# ThreadsPoster 變更日誌

本文件記錄了 ThreadsPoster 系統的所有版本變更。

## [v1.2.4] - 2025.04.08

### 新增功能
- **Quasar Alpha 模型整合**：成功整合並切換到 Quasar Alpha 模型進行內容生成，提供更優質的生成內容
- **內容生成優化**：調整內容生成流程，適配 Quasar Alpha 模型的特性
- **暫時關閉回文功能**：為確保系統穩定性，暫時關閉回文功能（2025-04-06）

### 功能改進
- **內容驗證機制**：簡化內容驗證流程，移除舊有的驗證限制，提高生成效率
- **系統初始化流程**：優化系統啟動流程，確保 Quasar Alpha 模型正確初始化
- **監控系統適配**：更新監控系統以支援新的內容生成模型

### 修復問題
- **內容生成器依賴**：修復內容生成器中的 speaking_patterns 依賴問題
- **模型切換問題**：解決切換到 Quasar Alpha 模型時的相容性問題
- **系統穩定性**：增強系統對新模型的支援，確保運行穩定性

### 開發與維護改進
- **代碼重構**：調整代碼結構以更好地支援 Quasar Alpha 模型
- **日誌優化**：改進日誌記錄，清晰顯示使用的模型類型
- **文檔更新**：更新 README 和相關文檔，反映最新的系統變更

## [v1.2.3] - 2025.04.04

### 新增功能
- **自動回覆系統**：添加對自己貼文的回覆監控和自動回應功能，提高用戶互動體驗
- **回覆優先處理**：系統優先處理他人對自己貼文的回覆，再發布新內容，改善用戶互動體驗
- **API密鑰管理優化**：分離標準API密鑰和專案API密鑰的使用，確保SDK和HTTP請求分別使用合適的憑證

### 功能改進
- **系統啟動介面優化**：美化系統啟動時的命令行輸出界面，使用表情符號和分隔線增強可讀性
- **回覆監控任務**：添加專用的回覆監控任務，定期檢查是否有新回覆需要處理
- **情感分析強化**：改進情感分析方法，使用標準API密鑰和JSON格式化響應，提高解析可靠性

### 修復問題
- **API密鑰錯誤**：修復使用專案API密鑰導致的情感分析401授權錯誤問題
- **代碼文件組織**：整理項目目錄結構，將測試檔案移至tests/目錄，腳本文件移至src/scripts/目錄
- **啟動腳本改進**：添加根目錄的一鍵啟動和安裝腳本，簡化用戶操作

### 開發與維護改進
- **環境變數配置**：優化.env文件中的API密鑰配置方式，分別設置標準和專案API密鑰
- **啟動輸出優化**：美化系統啟動時的統計信息和狀態顯示
- **安全性增強**：改進API密鑰顯示方式，只顯示部分字符，保護密鑰安全

## [v1.2.1] - 2025.04.02

### 新增功能
- **智能發文計劃生成**：實現每日發文計劃自動生成功能，在指定時段內均勻分布3-5個發文時間點
- **晚間集中發文**：將發文時間調整為晚上20:00至凌晨2:00，提高目標受眾的互動率

### 功能改進
- **發文頻率最佳化**：降低每日發文次數至3-5次，避免過度發文造成的互動疲勞
- **時間分段算法**：新增時間分段算法，確保發文時間點在指定時段內均勻分布
- **黃金時段調整**：將黃金發文時段設定在晚上21:00至凌晨1:00，根據用戶活躍度數據優化
- **監控器適配**：更新監控器邏輯，適配新的發文計劃系統，顯示更詳細的計劃信息

### 修復問題
- **跨日時間處理**：修復凌晨時段跨日計算問題，確保午夜後的發文時間正確處理
- **時間間隔計算**：優化時間間隔計算邏輯，避免過於密集的發文時間安排
- **發文計數追蹤**：修正發文計數追蹤機制，確保每日發文數量限制正確執行

### 開發與維護改進
- **發文數量限制**：調整系統默認發文上限，從原先的高頻率發文改為較低頻率的精準發文
- **等待時間顯示**：改進等待時間的顯示方式，同時顯示分鐘和秒數，提高可讀性
- **發文計劃日誌**：新增發文計劃詳細日誌，記錄每日計劃的時間點和執行情況

## [v1.2.0] - 2025.04.01

### 新增功能
- **組件初始化順序優化**：重新設計系統組件初始化順序，確保所有依賴正確加載，顯著提高系統啟動穩定性
- **模組間依賴關係增強**：優化AIHandler、ContentGenerator和ThreadsHandler之間的依賴設置方式，避免空引用錯誤
- **API連接管理改進**：增強ThreadsAPI的連接管理，自動檢測並創建session對象，確保API調用穩定性

### 功能改進
- **非同步初始化流程**：實現完全非同步的組件初始化，確保正確加載順序和依賴關係
- **錯誤處理機制強化**：完善模組間引用的錯誤處理，提高系統復原能力
- **可靠的資源管理**：改進Session對象和API連接的生命週期管理，減少連接洩漏和超時問題
- **組件間通信改進**：優化模組間的消息傳遞機制，提高系統各部分協作效率

### 修復問題
- **AIHandler初始化參數問題**：修正AIHandler初始化參數不匹配問題，確保正確加載config設定
- **ContentGenerator依賴設置**：解決ContentGenerator缺少threads_handler導致的運行時錯誤
- **ThreadsAPI連接管理**：修復ThreadsAPI中session為None時的錯誤處理，增加自動session創建機制
- **模組初始化順序**：解決由於初始化順序不當導致的組件間依賴問題

### 開發與維護改進
- **代碼健壯性增強**：提高系統對配置缺失和組件初始化失敗的容錯能力
- **運行時組件狀態驗證**：實現組件狀態自檢機制，及早捕獲並修復潛在問題
- **資源清理機制完善**：優化系統資源的分配和釋放流程，減少資源泄漏風險

## [v1.1.9] - 2025.03.31

### 新增功能
- **優化日誌格式**：重新設計日誌輸出格式，分類標籤使用【類別】標記，增加分隔線，便於系統監控和問題診斷
- **即時發文機制**：系統啟動後立即檢查並發布預先排程的內容，無需等待下一個發文周期
- **預先生成內容緩存**：在空閒時間預先生成多篇內容並緩存，降低高峰期負載，提高響應速度達35%
- **智能發文時間優化**：根據用戶活躍度和互動率自動調整最佳發文時段，提高互動效果
- **24小時運行優化**：特殊處理午夜時段和日期交替時的邊界情況，確保系統無縫運行
- **說話模式模組**：獨立出說話風格管理模組，根據場景、時間和主題自動調整表達方式，便於開發和管理

### 功能改進
- **監控邏輯增強**：改進系統運行監控邏輯，新增事件追蹤和統計分析，支持可視化報表
- **啟動效能提升**：優化系統啟動流程，減少冷啟動時間50%，資源使用效率提高40%
- **錯誤處理機制強化**：實現多層級的錯誤捕獲和恢復機制，系統穩定性提升85%
- **發文計數精確統計**：重設計發文統計算法，考慮時區因素和跨日統計，數據準確性達99.9%
- **資源管理最佳化**：實現智能的連接池管理和內存分配，降低資源泄漏風險，系統可持續運行時間延長300%
- **說話風格豐富化**：擴充表達模式庫，增加時間特定、場景特定和主題特定的表達方式，使內容更加多樣化

### 修復問題
- **資料庫處理**：修正資料庫處理器類別命名不一致問題，統一命名規範
- **時間控制器優化**：解決時間控制器在特定條件下的邊界處理問題，確保24小時無縫運行
- **發文間隔管理**：修復連續發文時可能出現的間隔計算錯誤，確保遵守平台發文頻率限制
- **表情符號過度使用**：修正在某些情況下表情符號過度使用或分布不均的問題

### 開發與維護改進
- **版本控制標準化**：所有源代碼文件添加統一的版權聲明和版本標記
- **文檔完善**：添加 CHANGELOG.md 和 CONTRIBUTING.md，詳細記錄版本變更和貢獻指南
- **自動化工具**：新增 `update_copyright.py` 腳本，自動更新所有源碼文件的版權和版本信息
- **資源整理**：移除舊版本的備份文件，優化倉庫結構，減少冗餘文件
- **模組化重構**：將說話風格獨立為模組，提高代碼可維護性和擴展性

## [v1.1.8] - 2025.03.30

### 新增功能
- 表達方式學習功能
- 性能監控與分析系統
- 資源使用優化機制
- API請求統計與分析

### 改進
- 改進人設記憶系統
- 優化內容生成流程
- 強化多語言支援
- 加強系統穩定性

### 修復
- 修復記憶體洩漏問題
- 解決日誌重複記錄問題
- 修正時區處理錯誤

## [v1.1.7] - 2025.03.20

### 新增功能
- 內容生成質量評估系統
- 自動化監控與通知
- 測試覆蓋率報告

### 改進
- 優化資料庫查詢效能
- 改進錯誤處理機制
- 加強系統日誌記錄

### 修復
- 修復資料庫連接池問題
- 解決API調用超時問題
- 修正日期轉換錯誤

## [v1.1.6] - 2025.03.10

### 新增功能
- 完整的錯誤處理與重試機制
- 系統日誌記錄與監控
- 人設記憶系統基礎實現

### 改進
- 優化發文時間管理
- 改進情感分析準確性
- 強化系統安全性

### 修復
- 修復資料庫交易問題
- 解決內容生成不完整問題
- 修正授權驗證錯誤

## [v1.1.5] - 2025.02.28

### 新增功能
- 自動添加表情符號功能
- 多語言支援（中、英、日）
- 記憶系統與主題連續性追蹤

### 改進
- 優化API使用效率
- 改進內容生成品質
- 加強資料安全性

### 修復
- 修復字元編碼問題
- 解決API限流問題
- 修正設定載入錯誤

## [v1.1.0] - 2025.02.15

### 新增功能
- OpenAI GPT-4 整合與內容生成
- MongoDB 最新版本資料庫整合
- 自動發文系統與時間管理基礎功能
- 情感分析與回應系統

### 改進
- 優化系統架構
- 改進資料模型
- 加強錯誤處理

## [v1.0.0] - 2025.02.01

### 初始版本
- 基礎系統架構建立
- 簡單的發文功能
- 基本的資料庫操作
- 簡易的API調用 